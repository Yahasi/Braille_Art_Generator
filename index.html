<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Braille ASCII Art Generator</title>
<style>
  :root{--bg:#0f1724;--card:#0b1220;--accent:#06b6d4;--muted:#94a3b8;color-scheme:dark}
  html,body{height:100%;margin:0;font-family:Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial}
  body{background:linear-gradient(180deg,#071029 0%, #071b2b 100%);color:#e6eef6;display:flex;align-items:flex-start;justify-content:center;padding:28px}
  .wrap{width:100%;max-width:1100px}
  .card{background:rgba(255,255,255,0.03);border-radius:12px;padding:18px;box-shadow:0 6px 30px rgba(2,6,23,0.6)}
  h1{margin:0 0 10px 0;font-size:20px}
  .row{display:flex;gap:12px;flex-wrap:wrap}
  .col{flex:1 1 260px}
  label{display:block;font-size:13px;color:var(--muted);margin-bottom:6px}
  input[type=file]{color:transparent}
  input[type=number], input[type=range], input[type=text], select{width:100%;padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.06);background:transparent;color:inherit}
  button{background:var(--accent);border:none;color:#022;background:none;padding:8px 12px;border-radius:8px;font-weight:600;cursor:pointer}
  button.secondary{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--muted)}
  .controls{display:grid;grid-template-columns:1fr 1fr;gap:12px}
  .preview{display:flex;gap:12px;align-items:flex-start}
  canvas{background:#fff;border-radius:6px;max-width:100%;height:auto}
  pre.output{white-space:pre;overflow:auto;padding:12px;border-radius:8px;background:#00121a;color:#e6eef6;font-family:monospace;line-height:0.9}
  .small{font-size:12px;color:var(--muted)}
  .actions{display:flex;gap:8px;flex-wrap:wrap}
  footer.small{margin-top:12px;color:var(--muted);font-size:13px}
  @media(max-width:720px){.controls{grid-template-columns:1fr} .row{flex-direction:column}}
</style>
</head>
<body>
<div class="wrap card">
  <h1>Braille ASCII Art Generator — single page (client-side)</h1>
  <div class="row" style="align-items:flex-start">
    <div class="col">
      <label class="small">Загрузить изображение</label>
      <input id="file" type="file" accept="image/*">
      <div style="height:12px"></div>
      <div class="controls">
        <div>
          <label>Ширина в символах (chars)</label>
          <input id="outWidth" type="number" min="1" value="80">
        </div>
        <div>
          <label>Высота в символах (chars)</label>
          <input id="outHeight" type="number" min="1" value="30">
        </div>
        <div>
          <label>Сохранить соотношение (chars)</label>
          <div style="display:flex;gap:8px;align-items:center"><input id="keepAspect" type="checkbox" checked><span class="small">(если отмечено, высота пересчитывается)</span></div>
        </div>
        <div>
          <label>Порог (threshold) 0..255</label>
          <input id="threshold" type="range" min="0" max="255" value="128">
          <div class="small" id="thresholdVal">128</div>
        </div>
        <div>
          <label>Инвертировать</label>
          <select id="invert"><option value="0">Нет</option><option value="1">Да</option></select>
        </div>
        <div>
          <label>Размер шрифта вывода (px)</label>
          <input id="fontSize" type="number" min="6" max="48" value="12">
        </div>
      </div>

      <div style="height:12px"></div>
      <div class="actions">
        <button id="generate">Сгенерировать</button>
        <button id="downloadTxt" class="secondary">Скачать .txt</button>
        <button id="copy" class="secondary">Копировать</button>
        <button id="downloadPng" class="secondary">Скачать PNG</button>
      </div>
      <div style="height:12px"></div>
      <div class="small">Подсказка: каждый символ braille кодирует блок 2×4 пикселя. Указывайте ширину/высоту в символах.</div>
    </div>

    <div class="col">
      <label class="small">Исходное изображение / изменённый холст</label>
      <div class="preview">
        <canvas id="srcCanvas" width="240" height="180" style="border:1px solid rgba(255,255,255,0.04)"></canvas>
        <canvas id="resCanvas" width="240" height="180" style="border:1px solid rgba(255,255,255,0.04)"></canvas>
      </div>
      <div style="height:12px"></div>
      <label class="small">Результат (текст с символами Braille)</label>
      <div style="height:8px"></div>
      <pre id="output" class="output" contenteditable></pre>
    </div>
  </div>
  <footer class="small">Работает полностью на клиенте — можно заливать на GitHub Pages (github.io). Ограничения: нет multi-threading на github.io.</footer>
</div>

<!-- Подключаем внешний скрипт генератора -->
<script src="braille-generator.js"></script>
</body>
</html>